<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>KG스틸 스타일 | 메일주소+이름+수신타입 → CSV</title>
<style>
  :root{
    /* 쉽게 조정할 수 있도록 컬러 토큰화 */
    --bg:#0e1526;              /* 배경 딥네이비 */
    --panel:#121b31;           /* 카드 배경 */
    --border:#1d2a4a;          /* 테두리 */
    --text:#e7ecf4;            /* 본문 */
    --muted:#a3b2c9;           /* 보조 텍스트 */
    --accent-start:#7c3aed;    /* 포인트(보라) */
    --accent-end:#e11d48;      /* 포인트(마젠타) */
    --accent:#8b5cf6;          /* 버튼 기본 */
    --accent-hover:#7a4fee;
    --success:#16a34a;
    --danger:#ffb4b4;
    --radius:14px;
    --shadow:0 10px 30px rgba(0,0,0,.25);
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple SD Gothic Neo","Noto Sans KR",sans-serif;
    background: radial-gradient(1200px 600px at 20% -10%, rgba(124,58,237,.18), transparent 60%),
                radial-gradient(1000px 500px at 110% 0%, rgba(225,29,72,.12), transparent 60%),
                var(--bg);
    color:var(--text);
  }

  /* 상단 헤더 */
  .hero{
    position:relative; padding:36px 20px 28px; overflow:hidden;
    border-bottom:1px solid var(--border);
    background:
      linear-gradient(120deg, rgba(124,58,237,.12), rgba(225,29,72,.10) 60%, transparent 100%);
  }
  .hero-inner{max-width:1200px;margin:0 auto;display:flex;gap:18px;align-items:flex-end;justify-content:space-between}
  .title{
    font-weight:800; letter-spacing:.2px;
    background:linear-gradient(90deg,var(--accent-start),var(--accent-end));
    -webkit-background-clip:text; background-clip:text; color:transparent; margin:0;
    font-size: clamp(22px, 3vw, 30px);
  }
  .subtitle{margin:6px 0 0; color:var(--muted); font-size:13px}
  .actions{display:flex; gap:10px}
  .btn{
    border:none; cursor:pointer; font-weight:700; padding:10px 14px; border-radius:10px;
    transition:.18s transform ease, .18s filter ease, .18s background ease;
  }
  .btn-primary{
    color:#fff; background:var(--accent);
  }
  .btn-primary:hover{ background:var(--accent-hover); transform:translateY(-1px) }
  .btn-ghost{
    color:var(--text); background:transparent; border:1px solid var(--border)
  }
  .btn-ghost:hover{filter:brightness(1.06)}

  /* 본문 카드 */
  .wrap{max-width:1200px;margin:22px auto 60px;padding:0 20px}
  .card{
    background:var(--panel); border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--shadow);
    padding:18px;
  }
  .grid{
    display:grid; gap:16px;
    grid-template-columns: 1fr 1fr 1fr;
  }
  label{display:flex; align-items:center; gap:8px; font-size:12px; color:var(--muted); margin-bottom:6px}
  .hint{margin-left:auto; color:var(--muted); font-size:11px; opacity:.85}
  textarea{
    width:100%; min-height:320px; resize:vertical; padding:12px 12px 42px 12px;
    color:var(--text); background:#0c1427; border:1px solid var(--border); border-radius:12px; outline:none;
    box-shadow: inset 0 0 0 1px rgba(124,58,237,.05);
  }
  textarea:focus{ box-shadow: 0 0 0 2px rgba(124,58,237,.35) }
  .row{display:flex; gap:12px; align-items:center; margin-top:14px; flex-wrap:wrap}
  .pill{
    font-size:12px; color:#dfe7ff; background:linear-gradient(90deg,rgba(124,58,237,.35),rgba(225,29,72,.35));
    border:1px solid var(--border); padding:5px 10px; border-radius:999px;
  }
  .grow{margin-left:auto; display:flex; gap:10px; align-items:center}
  .error{color:var(--danger); font-size:12px}
  .download{
    display:none; text-decoration:none; font-weight:800; color:#06240e; background:var(--success); padding:10px 12px; border-radius:10px;
  }
  .download:hover{filter:brightness(.95)}
  table{width:100%; border-collapse:collapse; margin-top:16px; font-size:14px; background:#0c1427; border:1px solid var(--border); border-radius:12px; overflow:hidden}
  th,td{padding:10px 12px; border-bottom:1px solid var(--border); text-align:left}
  th{color:var(--muted); font-weight:700; background:linear-gradient(180deg, rgba(124,58,237,.08), transparent)}
  tfoot td{color:var(--muted); font-size:12px}
  @media (max-width: 980px){ .grid{grid-template-columns:1fr} }
</style>
</head>
<body>
  <header class="hero">
    <div class="hero-inner">
      <div>
        <h1 class="title">메일 주소 · 이름 · 수신타입 → CSV</h1>
        
      </div>
      <div class="actions">
        <button id="btnSample" class="btn btn-ghost" type="button">샘플 채우기</button>
        <button id="btnMakeTop" class="btn btn-primary" type="button">CSV 만들기</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="card">
      <div class="grid">
        <div>
          <label>이메일 목록<span class="hint">한 줄에 하나</span></label>
          <textarea id="emails" placeholder="예)\nname1@kg-steel.co.kr\nname2@kggroup.co.kr"></textarea>
        </div>
        <div>
          <label>이름 목록<span class="hint">한 줄에 하나</span></label>
          <textarea id="names" placeholder="예)\n홍길동\n김철수"></textarea>
        </div>
        <div>
          <label>수신타입 목록<span class="hint">TO / CC / BCC, 한 줄에 하나</span></label>
          <textarea id="types" placeholder="예)\nTO\nCC\nBCC"></textarea>
        </div>
      </div>

      <div class="row">
        <span class="pill" id="stat">0행</span>
        <div class="grow">
          <span id="msg" class="error"></span>
          <a id="dl" class="download" download="email_list.csv">CSV 다운로드</a>
          <button id="btnClear" class="btn btn-ghost" type="button">입력 지우기</button>
          <button id="btnMake" class="btn btn-primary" type="button">CSV 만들기</button>
        </div>
      </div>

      <div id="preview"></div>
    </section>
  </main>

<script>
const $ = (s)=>document.querySelector(s);

function normalizeLines(text){
  return text
    .split(/\r?\n/)
    .map(s => s.trim())
    .filter(s => s.length>0);
}

function updateStat(){
  const e = normalizeLines($('#emails').value).length;
  const n = normalizeLines($('#names').value).length;
  const t = normalizeLines($('#types').value).length;
  $('#stat').textContent = `${Math.max(e,n,t)}행 (이메일 ${e} · 이름 ${n} · 타입 ${t})`;
}

['emails','names','types'].forEach(id=>{
  $('#'+id).addEventListener('input', updateStat);
});

function toCSV(rows){
  const header = ["메일주소","이름","수신타입"];
  const esc = v => {
    const s = String(v ?? "");
    return /[",\n]/.test(s) ? `"${s.replace(/"/g,'""')}"` : s;
  };
  const lines = [header, ...rows].map(r => r.map(esc).join(",")).join("\r\n");
  return "\uFEFF" + lines; // 엑셀 한글 깨짐 방지용 BOM
}

function buildCSV(){
  const msg = $('#msg'), dl = $('#dl'), preview = $('#preview');
  msg.textContent = ""; dl.style.display = "none"; preview.innerHTML = "";

  const emails = normalizeLines($('#emails').value);
  const names  = normalizeLines($('#names').value);
  let types    = normalizeLines($('#types').value).map(v => v.toUpperCase());

  if (emails.length === 0){ msg.textContent = "이메일을 입력해 주세요."; return; }
  if (names.length  === 0){ msg.textContent = "이름을 입력해 주세요."; return; }

  // 타입 줄 수가 부족하면 자동으로 TO 채움 (KG식 실무 편의)
  if (types.length < emails.length){
    const need = emails.length - types.length;
    types = types.concat(Array.from({length:need}, ()=> "TO"));
  }
  if (!(emails.length === names.length && names.length === types.length)){
    msg.textContent = `줄 수가 다릅니다. (이메일 ${emails.length} / 이름 ${names.length} / 수신타입 ${types.length})`;
    return;
  }

  // 유효성: 타입 정규화 (TO/CC/BCC 외 값은 경고 후 TO로 교정)
  const fixed = [];
  let warnCount = 0;
  types.forEach((t,i)=>{
    const v = (t||"").toUpperCase();
    if (!/^(TO|CC|BCC)$/.test(v)){ fixed[i] = "TO"; warnCount++; }
    else fixed[i] = v;
  });
  if (warnCount>0){
    msg.textContent = `알 수 없는 수신타입 ${warnCount}건을 TO로 교정했습니다.`;
  }

  const rows = emails.map((email,i)=>[email, names[i], fixed[i]]);

  // 미리보기
  const maxPreview = Math.min(12, rows.length);
  const table = document.createElement('table');
  table.innerHTML = `<thead><tr><th>메일주소</th><th>이름</th><th>수신타입</th></tr></thead>`;
  const tbody = document.createElement('tbody');
  rows.slice(0, maxPreview).forEach(r=>{
    const tr = document.createElement('tr');
    r.forEach(c=>{
      const td = document.createElement('td'); td.textContent = c; tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });
  table.appendChild(tbody);
  if (rows.length>maxPreview){
    const tf = document.createElement('tfoot');
    tf.innerHTML = `<tr><td colspan="3">총 ${rows.length}행 중 상위 ${maxPreview}행만 표시</td></tr>`;
    table.appendChild(tf);
  }
  preview.appendChild(table);

  // CSV 생성 & 링크
  const csv = toCSV(rows);
  const blob = new Blob([csv], {type:"text/csv;charset=utf-8"});
  dl.href = URL.createObjectURL(blob);
  dl.style.display = "inline-block";
}

$('#btnMake').addEventListener('click', buildCSV);
$('#btnMakeTop').addEventListener('click', buildCSV);

$('#btnClear').addEventListener('click',()=>{
  ['emails','names','types'].forEach(id=>$('#'+id).value="");
  $('#preview').innerHTML=""; $('#msg').textContent=""; $('#dl').style.display="none"; updateStat();
});

$('#btnSample').addEventListener('click',()=>{
  $('#emails').value = `wassssup@kggroup.co.kr
kjh0702@kggroup.co.kr
js138@kggroup.co.kr`;
  $('#names').value  = `홍길동
김두한
김철수`;
  $('#types').value  = `TO
CC
BCC`;
  updateStat();
});
</script>
</body>
</html>
